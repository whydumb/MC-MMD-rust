# MC-MMD-rust LOL

åœ¨ Minecraft 1.20.1 ä¸­å®ç° MMDï¼ˆMikuMikuDanceï¼‰æ¨¡å‹æ¸²æŸ“å’Œç‰©ç†æ¨¡æ‹Ÿçš„ Modã€‚

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## åŠŸèƒ½ç‰¹æ€§

- **PMX æ¨¡å‹åŠ è½½**: åœ¨ Minecraft ä¸­åŠ è½½å’Œæ¸²æŸ“ MMD æ¨¡å‹
- **VMD åŠ¨ç”»æ’­æ”¾**: æ”¯æŒéª¨éª¼å’Œè¡¨æƒ…å˜å½¢çš„ MMD åŠ¨ç”»æ’­æ”¾
- **ç‰©ç†æ¨¡æ‹Ÿ**: ä½¿ç”¨ Rapier3D å®ç°å¤´å‘ã€è¡£ç‰©ã€é…é¥°çš„å®æ—¶ç‰©ç†æ•ˆæœ
- **GPU è’™çš®**: é€šè¿‡ Compute Shader å®ç°é«˜æ€§èƒ½é¡¶ç‚¹è’™çš®
- **å¤šå±‚åŠ¨ç”»**: æ”¯æŒå¤šä¸ªåŠ¨ç”»åŒæ—¶æ··åˆæ’­æ”¾

## æ¶æ„

æœ¬é¡¹ç›®ç”±ä¸¤ä¸ªä¸»è¦éƒ¨åˆ†ç»„æˆï¼š

1. **rust_engine**: åŸºäº Rust çš„ MMD ç‰©ç†å’ŒåŠ¨ç”»å¼•æ“
   - PMX/VMD æ ¼å¼è§£æ
   - éª¨éª¼å±‚æ¬¡ç®¡ç†
   - ç‰©ç†æ¨¡æ‹Ÿï¼ˆRapier3Dï¼‰
   - JNI ç»‘å®šç”¨äº Java äº¤äº’

2. **Minecraft Mod**ï¼ˆFabric/Forgeï¼‰: åŸºäº Java çš„æ¸²æŸ“å’Œé›†æˆ
   - OpenGL æ¨¡å‹æ¸²æŸ“
   - Compute Shader è’™çš®
   - Iris å…‰å½±å…¼å®¹

## ä½¿ç”¨æ•™ç¨‹

### å®‰è£…

1. å°†æ¨¡ç»„ `.jar` æ–‡ä»¶æ”¾å…¥ `.minecraft/mods/` ç›®å½•
2. å¯åŠ¨æ¸¸æˆï¼Œæ¨¡ç»„ä¼šè‡ªåŠ¨åˆ›å»º `3d-skin` èµ„æºç›®å½•
3. å°†è‡ªå·±çš„æ¨¡å‹å’ŒåŠ¨ç”»æ–‡ä»¶æ”¾å…¥å¯¹åº”ç›®å½•ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰

### ç›®å½•ç»“æ„

æ¨¡ç»„ä½¿ç”¨ `.minecraft/3d-skin/` ä½œä¸ºèµ„æºæ ¹ç›®å½•ï¼Œç»“æ„å¦‚ä¸‹ï¼š

```
.minecraft/
â””â”€â”€ 3d-skin/
    â”œâ”€â”€ EntityPlayer/      # ç©å®¶æ¨¡å‹ç›®å½•
    â”‚   â”œâ”€â”€ æ¨¡å‹A/         # æ¯ä¸ªå­æ–‡ä»¶å¤¹æ˜¯ä¸€ä¸ªæ¨¡å‹ï¼Œæ–‡ä»¶å¤¹åå°±æ˜¯æ¨¡å‹å
    â”‚   â”‚   â”œâ”€â”€ model.pmx  # æ¨¡å‹æ–‡ä»¶ï¼ˆæ”¯æŒ .pmx/.pmdï¼‰
    â”‚   â”‚   â”œâ”€â”€ *.png      # è´´å›¾æ–‡ä»¶
    â”‚   â”‚   â”œâ”€â”€ dance.vmd  # æ¨¡å‹ä¸“å±åŠ¨ç”»ï¼ˆå¯é€‰ï¼‰
    â”‚   â”‚   â””â”€â”€ smile.vpd  # æ¨¡å‹ä¸“å±è¡¨æƒ…ï¼ˆå¯é€‰ï¼‰
    â”‚   â””â”€â”€ æ¨¡å‹B/
    â”‚       â””â”€â”€ ...
    â”œâ”€â”€ DefaultAnim/       # ç³»ç»Ÿé¢„è®¾åŠ¨ç”»ï¼ˆæ¨¡ç»„è‡ªåŠ¨é‡Šæ”¾ï¼‰
    â”œâ”€â”€ CustomAnim/        # ç”¨æˆ·è‡ªå®šä¹‰åŠ¨ç”»
    â”œâ”€â”€ DefaultMorph/      # ç³»ç»Ÿé¢„è®¾è¡¨æƒ…
    â”œâ”€â”€ CustomMorph/       # ç”¨æˆ·è‡ªå®šä¹‰è¡¨æƒ…
    â””â”€â”€ Shader/            # è‡ªå®šä¹‰ç€è‰²å™¨
```

### æ–‡ä»¶å¤¹è¯¦è§£

#### `EntityPlayer/` - ç©å®¶æ¨¡å‹ç›®å½•

å­˜æ”¾ç©å®¶å¯ç”¨çš„ MMD æ¨¡å‹ã€‚**æ¯ä¸ªæ¨¡å‹å¿…é¡»æ”¾åœ¨ç‹¬ç«‹çš„å­æ–‡ä»¶å¤¹ä¸­**ã€‚

| æ–‡ä»¶ç±»å‹ | æ‰©å±•å | è¯´æ˜ |
|---------|--------|------|
| æ¨¡å‹æ–‡ä»¶ | `.pmx` / `.pmd` | å¿…éœ€ï¼ŒPMX ä¼˜å…ˆäº PMD |
| è´´å›¾æ–‡ä»¶ | `.png` / `.jpg` / `.bmp` / `.tga` | æ¨¡å‹å¼•ç”¨çš„è´´å›¾ |
| ä¸“å±åŠ¨ç”» | `.vmd` | å¯é€‰ï¼Œä»…è¯¥æ¨¡å‹å¯ç”¨ |
| ä¸“å±è¡¨æƒ… | `.vpd` | å¯é€‰ï¼Œä»…è¯¥æ¨¡å‹å¯ç”¨ |

**æ¨¡å‹è¯†åˆ«è§„åˆ™**ï¼š
- æ‰«ææ¯ä¸ªå­æ–‡ä»¶å¤¹ï¼ŒæŸ¥æ‰¾ `.pmx` æˆ– `.pmd` æ–‡ä»¶
- è‹¥æ–‡ä»¶å¤¹å†…æœ‰å¤šä¸ªæ¨¡å‹æ–‡ä»¶ï¼Œä¼˜å…ˆé€‰æ‹© `model.pmx` æˆ– `model.pmd`
- è‹¥æ—  `model.*`ï¼Œåˆ™æŒ‰æ–‡ä»¶åæ’åºé€‰æ‹©ç¬¬ä¸€ä¸ª

**ç¤ºä¾‹**ï¼š
```
EntityPlayer/
â”œâ”€â”€ miku/
â”‚   â”œâ”€â”€ model.pmx          # âœ“ è¢«åŠ è½½
â”‚   â”œâ”€â”€ body.png
â”‚   â””â”€â”€ face.png
â””â”€â”€ shiroha/
    â”œâ”€â”€ cirno_v2.pmx       # âœ“ è¢«åŠ è½½ï¼ˆæ–‡ä»¶å¤¹å†…å”¯ä¸€ pmxï¼‰
    â”œâ”€â”€ cirno_old.pmd      # âœ— å¿½ç•¥ï¼ˆpmx ä¼˜å…ˆï¼‰
    â””â”€â”€ texture.png
```

#### `DefaultAnim/` - ç³»ç»Ÿé¢„è®¾åŠ¨ç”»

æ¨¡ç»„é¦–æ¬¡å¯åŠ¨æ—¶è‡ªåŠ¨ä»å†…ç½®èµ„æºé‡Šæ”¾ï¼ŒåŒ…å«æ¸¸æˆçŠ¶æ€å¯¹åº”çš„åŸºç¡€åŠ¨ç”»ï¼š

| åŠ¨ç”»æ–‡ä»¶å | è§¦å‘æ¡ä»¶ |
|-----------|----------|
| `idle.vmd` | ç«™ç«‹é™æ­¢ |
| `walk.vmd` | è¡Œèµ° |
| `sprint.vmd` | ç–¾è·‘ |
| `sneak.vmd` | æ½œè¡Œ |
| `swim.vmd` | æ¸¸æ³³ |
| `crawl.vmd` | åŒåŒ |
| `sleep.vmd` | ç¡è§‰ |
| `die.vmd` | æ­»äº¡ |
| `elytraFly.vmd` | é˜ç¿…é£è¡Œ |
| `onClimbable.vmd` | æ”€çˆ¬ï¼ˆé™æ­¢ï¼‰ |
| `onClimbableUp.vmd` | æ”€çˆ¬ï¼ˆä¸Šï¼‰ |
| `onClimbableDown.vmd` | æ”€çˆ¬ï¼ˆä¸‹ï¼‰ |
| `onHorse.vmd` / `ride.vmd` | éª‘ä¹˜ |
| `lieDown.vmd` | èººä¸‹ |
| `swingLeft.vmd` | å·¦æ‰‹æŒ¥åŠ¨ |
| `swingRight.vmd` | å³æ‰‹æŒ¥åŠ¨ |
| `itemActive_*.vmd` | ç‰©å“ä½¿ç”¨åŠ¨ç”» |

> **æ³¨æ„**ï¼šå¯ç›´æ¥æ›¿æ¢è¿™äº›æ–‡ä»¶æ¥è‡ªå®šä¹‰åŸºç¡€åŠ¨ç”»ï¼Œä½†å»ºè®®å¤‡ä»½åŸæ–‡ä»¶ã€‚

#### `CustomAnim/` - ç”¨æˆ·è‡ªå®šä¹‰åŠ¨ç”»

å­˜æ”¾ç”¨æˆ·æ·»åŠ çš„ `.vmd` åŠ¨ç”»æ–‡ä»¶ï¼Œå¯é€šè¿‡åŠ¨ä½œè½®ç›˜æ‰‹åŠ¨è§¦å‘æ’­æ”¾ã€‚

**å‘½åå»ºè®®**ï¼šæ–‡ä»¶åå³ä¸ºæ˜¾ç¤ºåç§°ï¼Œå»ºè®®ä½¿ç”¨æœ‰æ„ä¹‰çš„åç§°å¦‚ `è·³èˆ.vmd`ã€`æ‰“æ‹›å‘¼.vmd`ã€‚

#### `DefaultMorph/` - ç³»ç»Ÿé¢„è®¾è¡¨æƒ…

å­˜æ”¾ç³»ç»Ÿé¢„è®¾çš„ `.vpd` è¡¨æƒ…æ–‡ä»¶ï¼ˆå¦‚çœ¨çœ¼ã€å¾®ç¬‘ç­‰ï¼‰ã€‚

#### `CustomMorph/` - ç”¨æˆ·è‡ªå®šä¹‰è¡¨æƒ…

å­˜æ”¾ç”¨æˆ·æ·»åŠ çš„ `.vpd` è¡¨æƒ…æ–‡ä»¶ï¼Œå¯é€šè¿‡è¡¨æƒ…è½®ç›˜æ‰‹åŠ¨è§¦å‘ã€‚

### åŠ¨ç”»åŠ è½½ä¼˜å…ˆçº§

å½“éœ€è¦æ’­æ”¾åŠ¨ç”»æ—¶ï¼Œæ¨¡ç»„æŒ‰ä»¥ä¸‹é¡ºåºæŸ¥æ‰¾ï¼š

1. **æ¨¡å‹ä¸“å±ç›®å½•** (`EntityPlayer/æ¨¡å‹å/*.vmd`) - æœ€é«˜ä¼˜å…ˆçº§
2. **è‡ªå®šä¹‰åŠ¨ç”»ç›®å½•** (`CustomAnim/*.vmd`)
3. **é»˜è®¤åŠ¨ç”»ç›®å½•** (`DefaultAnim/*.vmd`) - æœ€ä½ä¼˜å…ˆçº§

è¿™æ„å‘³ç€ä½ å¯ä»¥ä¸ºç‰¹å®šæ¨¡å‹åˆ›å»ºä¸“å±åŠ¨ç”»ï¼Œè¦†ç›–é€šç”¨åŠ¨ç”»ã€‚

**ç¤ºä¾‹**ï¼šè‹¥ `EntityPlayer/åˆéŸ³æœªæ¥/idle.vmd` å­˜åœ¨ï¼Œåˆ™è¯¥æ¨¡å‹çš„ç«™ç«‹åŠ¨ç”»ä½¿ç”¨æ­¤æ–‡ä»¶ï¼Œè€Œé `DefaultAnim/idle.vmd`ã€‚

### å¿«æ·é”®æ“ä½œ

#### ä¸»é…ç½®è½®ç›˜ï¼ˆæŒ‰ä½ `Alt` é”®ï¼‰

æŒ‰ä½ `Alt` é”®æ‰“å¼€ä¸»é…ç½®è½®ç›˜ï¼Œç§»åŠ¨é¼ æ ‡é€‰æ‹©åŠŸèƒ½ï¼Œæ¾å¼€ `Alt` ç¡®è®¤ï¼š

| é€‰é¡¹ | åŠŸèƒ½ |
|------|------|
| ğŸ­ **æ¨¡å‹åˆ‡æ¢** | æ‰“å¼€æ¨¡å‹é€‰æ‹©ç•Œé¢ï¼Œåˆ‡æ¢ç©å®¶ä½¿ç”¨çš„ MMD æ¨¡å‹ |
| ğŸ¬ **åŠ¨ä½œé€‰æ‹©** | æ‰“å¼€åŠ¨ä½œè½®ç›˜ï¼Œæ‰‹åŠ¨æ’­æ”¾ `CustomAnim/` ä¸­çš„åŠ¨ç”» |
| ğŸ˜Š **è¡¨æƒ…é€‰æ‹©** | æ‰“å¼€è¡¨æƒ…è½®ç›˜ï¼Œåº”ç”¨ `CustomMorph/` ä¸­çš„è¡¨æƒ… |
| ğŸ‘• **æè´¨æ§åˆ¶** | æ§åˆ¶æ¨¡å‹å„éƒ¨ä½æè´¨çš„æ˜¾ç¤º/éšè— |
| âš™ **æ¨¡ç»„è®¾ç½®** | æ‰“å¼€æ¨¡ç»„é…ç½®ç•Œé¢ |

#### å¥³ä»†é…ç½®è½®ç›˜ï¼ˆå¯¹å‡†å¥³ä»†æŒ‰ `B` é”®ï¼‰

è‹¥å®‰è£…äº† TouhouLittleMaid æ¨¡ç»„ï¼Œå¯¹å‡†å¥³ä»†å®ä½“æŒ‰ `B` é”®å¯æ‰“å¼€å¥³ä»†ä¸“ç”¨é…ç½®è½®ç›˜ã€‚

> **æç¤º**ï¼šå¿«æ·é”®å¯åœ¨æ¸¸æˆè®¾ç½® â†’ æ§åˆ¶ â†’ MMD Skin åˆ†ç±»ä¸­è‡ªå®šä¹‰ã€‚

### æ¨¡å‹åˆ‡æ¢ç•Œé¢

æŒ‰ä½ `Alt` â†’ é€‰æ‹©ã€Œæ¨¡å‹åˆ‡æ¢ã€è¿›å…¥ï¼š

- æ˜¾ç¤º `EntityPlayer/` ä¸‹æ‰€æœ‰å¯ç”¨æ¨¡å‹
- æ˜¾ç¤ºæ¨¡å‹æ ¼å¼ï¼ˆPMX/PMDï¼‰ã€æ–‡ä»¶åã€æ–‡ä»¶å¤§å°
- ç‚¹å‡»æ¨¡å‹å¡ç‰‡ç«‹å³åˆ‡æ¢
- é€‰æ‹©ã€Œé»˜è®¤ã€æ¢å¤åŸç‰ˆç©å®¶çš®è‚¤æ¸²æŸ“
- ç‚¹å‡»ã€Œåˆ·æ–°ã€é‡æ–°æ‰«ææ¨¡å‹ç›®å½•

### åŠ¨ä½œ/è¡¨æƒ…è½®ç›˜é…ç½®

åŠ¨ä½œè½®ç›˜å’Œè¡¨æƒ…è½®ç›˜æ”¯æŒè‡ªå®šä¹‰æ§½ä½ï¼š

1. æ‰“å¼€å¯¹åº”è½®ç›˜ç•Œé¢
2. ç‚¹å‡»å³ä¸‹è§’ âš™ æŒ‰é’®è¿›å…¥é…ç½®ç•Œé¢
3. ä»å¯ç”¨åˆ—è¡¨ä¸­æ·»åŠ /ç§»é™¤æ§½ä½
4. æ‹–æ‹½è°ƒæ•´é¡ºåº

é…ç½®ä¿å­˜åœ¨ `.minecraft/config/mmdskin/` ç›®å½•ä¸‹ã€‚

## æ„å»º

### å‰ç½®è¦æ±‚

- Rust 1.70+ï¼ˆç”¨äº rust_engineï¼‰
- JDK 17+ï¼ˆç”¨äº Minecraft modï¼‰
- Gradle 8.x

### æ„å»º rust_engine

```bash
cd rust_engine
cargo build --release
```

### æ„å»º Minecraft Mod

```bash
./gradlew build
```

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## è‡´è°¢

æœ¬é¡¹ç›®åŸºäºä¼—å¤šå¼€æºé¡¹ç›®å’Œè´¡çŒ®è€…çš„å·¥ä½œã€‚
å®Œæ•´è‡´è°¢è¯·å‚é˜… [ACKNOWLEDGMENTS.md](ACKNOWLEDGMENTS.md)ã€‚

### æ ¸å¿ƒä¾èµ–

| åº“ | è®¸å¯è¯ | è¯´æ˜ |
|----|--------|------|
| [Rapier](https://rapier.rs) | Apache-2.0 | 3D ç‰©ç†å¼•æ“ |
| [glam](https://github.com/bitshifter/glam-rs) | MIT/Apache-2.0 | 3D æ•°å­¦åº“ |
| [mmd-rs](https://github.com/aankor/mmd-rs) | BSD-2-Clause | MMD æ ¼å¼è§£æå™¨ |

### è®¾è®¡å‚è€ƒ

| é¡¹ç›® | è®¸å¯è¯ | å‚è€ƒå†…å®¹ |
|------|--------|----------|
| [KAIMyEntity](https://github.com/kjkjkAIStudio/KAIMyEntity) | MIT | åŸå§‹ Minecraft MMD æ¨¡ç»„ |
| [KAIMyEntity-C](https://github.com/Gengorou-C/KAIMyEntity-C) | MIT | æœ¬é¡¹ç›®çš„ç›´æ¥å‰èº«ï¼ˆäºŒæ¬¡å¼€å‘åŸºç¡€ï¼‰ |
| [Saba](https://github.com/benikabocha/saba) | MIT | ç‰©ç†ç³»ç»Ÿæ¶æ„ |
| [nphysics](https://github.com/dimforge/nphysics) | Apache-2.0 | éª¨éª¼å±‚æ¬¡è®¾è®¡ |
| [mdanceio](https://github.com/ReaNAiveD/mdanceio) | MIT | åŠ¨ç”»ç³»ç»Ÿ |

å®Œæ•´çš„ç¬¬ä¸‰æ–¹è®¸å¯è¯ä¿¡æ¯è¯·å‚é˜… [THIRD_PARTY_LICENSES.md](THIRD_PARTY_LICENSES.md)ã€‚

## ç›¸å…³é¡¹ç›®

- [MikuMikuDance](https://sites.google.com/view/vpvp/) - æ¨‹å£å„ªå¼€å‘çš„åŸç‰ˆ MMD è½¯ä»¶
- [Saba](https://github.com/benikabocha/saba) - C++ MMD åº“
- [Rapier](https://rapier.rs) - Rust ç‰©ç†å¼•æ“
